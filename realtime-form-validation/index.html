<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>realtime form validation</title>
    <style>
        .input-requirements {
        list-style: disc;
        color: rgb(150,150,150);
        }


        .input-requirements li.invalid {
            color: #e74c3c;
        }
        .input-requirements li.valid {
            color: #2ecc71;
        }

        .input-requirements li.valid:after {
            display: inline-block;
            padding-left: 10px;
            content: "\2713";
        }

        .input-requirements li.invalid:after {
            display: inline-block;
            padding-left: 10px;
            content: "\2715";
        }

        /* Hide and show related .input-requirements when interacting with input */

        input:not([type="submit"]) + .input-requirements {
        overflow: hidden;
        max-height: 0;
        transition: max-height 1s ease-out;  
        }

        input:not([type="submit"]):hover + .input-requirements,
        input:not([type="submit"]):focus + .input-requirements,
        input:not([type="submit"]):active + .input-requirements {
        max-height: 1000px; /* any large number (bigger then the .input-requirements list) */
        transition: max-height 1s ease-in;
        }

    </style>
</head>
<body>
    <label for="username">
        <input type="text" placeholder="username" id="username" minlength="3" required>
        <ul class="input-requirements">
            <li>Minimal 3 karakter</li>
            <li>Hanya boleh berisi huruf dan angka (tidak ada karakter khusus)</li>
        </ul>
    </label>

    <script type="text/javascript">
        function CustomValidation() {
            this.invalidities = [];

            this.validityChecks = [];
        }

        CustomValidation.prototype = {
            addInvalidity: function (message) {
                this.invalidities.push(message);
            },
            getInvalidities: function () {
                return this.invalidities.join('. \n');
            },
            checkValidity: function (input) {
                for (var i = 0; i < validityChecks.length; i++) {
                    var isInvalid = validityChecks[i].isInvalid(input);
                    if(isInvalid){
                        this.addInvalidity(validityChecks[i].invalidityMessage);
                        validityChecks[i].element.classList.add('invalid');
                        validityChecks[i].element.classList.remove('valid');
                    }else{
                        validityChecks[i].element.classList.remove('invalid');
                        validityChecks[i].element.classList.add('valid');
                    }
                    
                }
            }
        };

        var usernameValidityChecks = [
            {
                isInvalid: function (input) {
                    return input.value.length < 3;
                },
                invalidityMessage: 'Minimal 3 karakter',
                element: document.querySelector('label[for="username"] .input-requirements li:nth-child(1)')
            },
            {
                isInvalid:function(input){
                    var illegalCharacters = input.value.match(/[^a-zA-Z0-9]/g);
                    return illegalCharacters ? true : false;
                },
            invalidityMessage:'Hanya boleh berisi huruf dan angka (tidak ada karakter khusus)',
            element: document.querySelector('label[for="username"] .input-requirements li:nth-child(2)')
            }
        ]

        var usernameInput = document.getElementById('username');

        usernameInput.CustomValidation = new CustomValidation();
        usernameInput.CustomValidation.validityChecks = usernameValidityChecks;

        usernameInput.addEventListener('keyup', function () {
            usernameInput.CustomValidation.checkValidity(this);
        });
    </script>
</body>
</html>